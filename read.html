
<!doctype html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="bulma.min.css" />
  <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
  <script src="	https://cdnjs.cloudflare.com/ajax/libs/vue-chartjs/3.5.0/vue-chartjs.min.js"></script>

    <style>
.modal-mask {
  position: fixed;
  z-index: 9998;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, .5);
  display: table;
  transition: opacity .3s ease;
}

.modal-wrapper {
  display: table-cell;
  vertical-align: middle;
}

.modal-container {
  width: 300px;
  margin: 0px auto;
  padding: 20px 30px;
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, .33);
  transition: all .3s ease;
  font-family: Helvetica, Arial, sans-serif;
}

.modal-header h3 {
  margin-top: 0;
  color: #42b983;
}

.modal-body {
  margin: 20px 0;
}

.modal-default-button {
  float: right;
}

.modal-enter {
  opacity: 0;
}

.modal-leave-active {
  opacity: 0;
}

.modal-enter .modal-container,
.modal-leave-active .modal-container {
  -webkit-transform: scale(1.1);
  transform: scale(1.1);
}
    </style>


</head>
<title></title>

<body>
<script type="text/x-template" id="modal-template">
  <transition name="modal">
    <div class="modal-mask">
      <div class="modal-wrapper">
        <div class="modal-container">

          <div class="modal-header">
            <slot name="header">
              
            </slot>

          </div>
          <div class="modal-body">
            <slot name="body">
            </slot>
            <canvas id="canvas"></canvas>
          </div>
         
              <button class="modal-default-button" @click="$emit('close')">
                X
              </button>
            </slot>
          </div>
        </div>
      </div>
    </div>
  </transition>
</script>
    <div id="app">

        <table border=1>
            <tr>
                
                <td>id</td>
                <td>title</td>
                <td>author</td>
                <td>category</td>
                <td>price</td>
                <td>created</td>
                <td>수정</td>
                <td>삭제</td>
            </tr>
            
            <tr v-for="ab in datas" v-bind:key="ab.id" >
               
                
                
                <td>{{ab.id}}</td>
                <td>{{ab.title}}</td>
                <td>{{ab.author}}</td>
                <td>{{ab.category}}</td>
                <td>{{ab.price}}</td>
                <td>{{ab.created}}</td>
                <td onclick="event.cancelBubble=true"><button @click="insert(ab.id)">update</button></td>
                <td onclick="event.cancelBubble=true"><button @click="dele(ab.id)">delete</button></td>
                

            </tr>
                
            

    </div>
    </table>
<button id="show-modal" @click="showModal = true">그래프 표시</button>

<modal v-if="showModal" @close="showModal = false">

    <h3 slot="header">custom header</h3>
</modal>
    </div>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
    <script src="https://unpkg.com/vue-router"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-style@0.5.0"></script>
    
    <script>

        Chart.defaults.global.defaultFontFamily = "monospace";

        let data = [1, 10, 5, 2, 20, 30, 45];
          let moreData = [20, 30, 15, 12, 21, 30, 40];
          let log = [
            { x: 1, y: 1 },
            { x: 2, y: 2 },
            { x: 3, y: 3 },
            { x: 4, y: 4 },
            { x: 5, y: 5 },
            { x: 6, y: 6 },
            { x: 7, y: 70 },

          ]
        


        Vue.component('modal', {
          template: '#modal-template',
          mounted: () => {
            var ctx = document.getElementById('canvas').getContext('2d');
            var myChart = new Chart(ctx, {
              type: 'line',
              data: {
                labels: ["a", "b", "c", "d", "e", "f", "g"],
                datasets: [
                  {
                    label: "Data",
                    fill: false,
                    backgroundColor: 'rgb(190, 99, 255, 0.25)',
                    borderColor: 'rgb(190, 99, 255)',
                    data: data,
                  },
                  {
                    label: "More data",
                    fill: false,
                    backgroundColor: 'rgba(255, 99, 132, 0.25)',
                    borderColor: 'rgb(255, 99, 132)',
                    data: moreData,
                  },
                  {
                    label: "log data",
                    fill: false,
                    backgroundColor: 'rgba(0, 0 ,0, 0.25)',
                    borderColor: 'rgb(0, 0, 0)',
                    data: log,
                  }]
              }
            });
          }
        })

 
  
        var getValue = localStorage.getItem('token');
            console.log(getValue); 

            if(!getValue){
                 window.location.href = 'http://localhost:10081/';
            }
     var router = new VueRouter({

               mode: 'history',

               routes: []

         });


        var vm = new Vue({
            router,
            el: '#app',
            data:
            
            
             {

                showModal: false,

                datas: [{}],
                
                token : getValue,
                message: 'Vue',
                ab : false,
                userIds: [],
                url: 'http://localhost:10081/',
                id :""


            },
     

             mounted: function () {

                parameters = this.$route.query

                console.log(parameters)



                id = this.$route.query.id




            },

            
            methods: {


            getData: function () {
                    axios.get('http://localhost:10081/api/books')
                        .then(function (response) {
                            console.log(response.data);
                            this.datas = response.data;
                            console.log(this.datas);
                        })
                },

                getDataone: function (id) {
                    axios.get('http://localhost:10081/api/books/'+id)
                        .then(function (response) {
                            console.log(response.data);
                            window.location.href = 'http://localhost:10081/read.html?id='+ id;
                        })
                },
                add: function () {
                    axios.post('http://localhost:10081/api/books/add', {

                        title: '1224qweqweqwe421',
                        author: '',
                        category: 'google',
                        price: '123222'
                    })
                        .then(function (response) {
                            console.log(response.data);
                        })
                },
                update: function (id) {
                    axios.put('http://localhost:10081/api/books/update/' + id, {

                        title: '1224qweqweqwe421',
                        author: '',
                        category: 'google',
                        price: '123222'
                    })
                        .then(function (response) {
                            console.log(response.data);
                        })
                },
                del: function () {
                    axios.delete('http://localhost:10081/api/books/delete/99', {

                    })
                        .then(function (response) {
                            console.log(response.data);
                        })
                },
             gettoken: function() {
                 axios.post('http://localhost:10081/api/books/gettoken', {
                    
                        token: vm.token
                })
                    .then(function (response) {
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.log(error);
                    });

                



            },
             
         insert: function (id) {
            window.location.href = 'http://localhost:10081/update.html?id='+id

            },
         dele: function (id) {
             axios.delete('http://localhost:10081/api/books/delete/' + id, {

             })
                 .then(function (response) {
                     alert(id +  '번 삭제 완료');
                    window.location.href = 'http://localhost:10081/test.html';

                 })
               }



        }

        }).$mount('#app');

           axios.get('http://localhost:10081/api/books/' + id) //<-id값
            .then(function (response) {

          console.log(response.data)
          vm.datas = response.data
          console.log(vm.datas);

             });
           


       

   

/*         axios.post('http://localhost:10081/api/books/add', {

            title: '1224qweqweqwe421',
            author: 'dnerkekekek2ek하하하',
            category: 'google',
            price: '123222'
        })
            .then(function (response) {
                console.log(response.data);
            })
            .catch(function (error) {
                console.log(error);
            });
        axios.put('http://localhost:10081/api/books/update/10', {

            title: '1224qweqwe22qwe421',
            author: 'dnerkekekek2222ek하',
            category: 'goog22le',
            price: '12322222'
        })
            .then(function (response) {
                console.log(response.data);
            })
            .catch(function (error) {
                console.log(error);
            });
        axios.delete('http://localhost:10081/api/books/delete/118', {

        })
            .then(function (response) {
                console.log(response.data);
            })
            .catch(function (error) {
                console.log(error);
            });
    axios.post('http://localhost:10081/api/books/gettoken', {
        
        
            token : vm.token
       

    })
        .then(function (response) {
            
          
            console.log(response.data);
            console.log(vm.token);
        })
        .catch(function (error) {
            console.log(error);
        });
         */
        

                    

    </script>

</body>